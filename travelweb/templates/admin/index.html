{% extends "admin/base_site.html" %}
{% load i18n admin_urls admin_list static log %}

{# ===== –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ / –∑–∞–≥–æ–ª–æ–≤–æ–∫ ===== #}
{% block breadcrumbs %}
  <div class="content-header">
    <div class="container-fluid">
      <h1 class="ac-title">{% trans "–ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê" %}</h1>
    </div>
  </div>
{% endblock %}

{# ===== –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç ===== #}
{% block content %}
<div class="ac-container">

  {# –†—è–¥: –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è + –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ #}
  <div class="ac-grid">
    <section class="ac-card">
      <header class="ac-card__head">{% trans "–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è" %}</header>
      <div class="ac-card__body">
        <div class="ac-actions">
          {% if perms.travelapp.add_trip %}
            <a class="btn btn-primary" href="{% url 'admin:travelapp_trip_add' %}">‚ûï {% trans "–ù–æ–≤—ã–π —Ç—É—Ä" %}</a>
          {% endif %}
          {% if perms.travelapp.view_trip %}
            <a class="btn btn-outline-secondary" href="{% url 'admin:travelapp_trip_changelist' %}">üìã {% trans "–í—Å–µ —Ç—É—Ä—ã" %}</a>
          {% endif %}
          {% if perms.travelapp.view_country %}
            <a class="btn btn-outline-secondary" href="{% url 'admin:travelapp_country_changelist' %}">üåç {% trans "–°—Ç—Ä–∞–Ω—ã" %}</a>
          {% endif %}
        </div>
      </div>
    </section>

    <aside class="ac-card">
      <header class="ac-card__head">{% trans "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" %}</header>
      <div class="ac-card__body">
        <ul class="ac-stats">
          <li>{% trans "–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–æ–≤:" %} ‚Äî <!-- TODO: –º–æ–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ --></li>
          <li>{% trans "–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥:" %} {{ request.user.last_login|date:"d.m.Y H:i" }}</li>
        </ul>
      </div>
    </aside>
  </div>

  {# –†—è–¥: –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è #}
  <div class="ac-grid">
    <section class="ac-card">
      <header class="ac-card__head">{% trans "–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è" %}</header>
      <div class="ac-card__body">
        {% get_admin_log 8 as admin_log for_user user %}
        {% if not admin_log %}
          <div class="empty-state">{% trans "–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ" %}</div>
        {% else %}
          <ul class="ac-models">
            {% for entry in admin_log %}
              <li class="ac-model">
                <span>
                  {% if entry.is_deletion or not entry.get_admin_url %}
                    <span class="ac-model__name">{{ entry.object_repr }}</span>
                  {% else %}
                    <a class="ac-model__name" href="{{ entry.get_admin_url }}">{{ entry.object_repr }}</a>
                  {% endif %}
                  <small style="opacity:.75">‚Äî {{ entry.content_type.name }}</small>
                </span>
                <div class="ac-model__tools">
                  <span class="ac-chip">
                    {% if entry.is_addition %}{% trans "–°–æ–∑–¥–∞–Ω–∏–µ" %}
                    {% elif entry.is_change %}{% trans "–ò–∑–º–µ–Ω–µ–Ω–∏–µ" %}
                    {% elif entry.is_deletion %}{% trans "–£–¥–∞–ª–µ–Ω–∏–µ" %}
                    {% endif %}
                  </span>
                </div>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
    </section>
  </div>

  {# –†—è–¥: –°–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π/–º–æ–¥–µ–ª–µ–π #}
  <div class="ac-grid">
    {% if app_list %}
      {% for app in app_list %}
        <section class="ac-card">
          <header class="ac-card__head">{{ app.name }}</header>
          <div class="ac-card__body">
            <ul class="ac-models">
              {% for model in app.models %}
                <li class="ac-model">
                  {% if model.admin_url %}
                    <a class="ac-model__name" href="{{ model.admin_url }}">{{ model.name }}</a>
                  {% else %}
                    <span class="ac-model__name">{{ model.name }}</span>
                  {% endif %}
                  <div class="ac-model__tools">
                    {% if model.add_url %}
                      <a href="{{ model.add_url }}" class="btn btn-success btn-sm">{% trans "–î–æ–±–∞–≤–∏—Ç—å" %}</a>
                    {% endif %}
                    {% if model.admin_url %}
                      <a href="{{ model.admin_url }}" class="btn btn-info btn-sm">{% trans "–ò–∑–º–µ–Ω–∏—Ç—å" %}</a>
                    {% endif %}
                  </div>
                </li>
              {% endfor %}
            </ul>
          </div>
        </section>
      {% endfor %}
    {% else %}
      <section class="ac-card">
        <header class="ac-card__head">{% trans "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è" %}</header>
        <div class="ac-card__body">
          <div class="empty-state">{% trans "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏–ª–∏ –ø—Ä–∞–≤." %}</div>
        </div>
      </section>
    {% endif %}
  </div>

</div>
{% endblock %}
